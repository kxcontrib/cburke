<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<style>body {margin: 1em 5% 1em 5%}
b,pre,tt {color:#000080}
pre {background:#fffaf4; border:1pt solid #aebdcc; padding:5pt}
h1,h2,h3 {color:#015293;font-family:sans-serif;border-bottom:2px solid silver;
 margin-top:1.2em;margin-bottom:0.5em;line-height:1.3}
</style>
<title>Build hdb</title>
</head><body>
<h1 id="buildhdb">Build hdb</h1>
<p>
This script builds a small historical database, useful when learning q.
The main tables are partitioned on date.
<p>
The first few lines are the configuration, modify as needed:
<pre>dst:`:db/tickdemo   / database root
bgn:2007.01.01      / begin, end (only mon-fri used)
end:2010.12.31
nt:1000             / trades per stock per day
qpt:5               / quotes per trade
npt:3               / nbbo per trade
nl2:1000            / level II entries in day
\S 269157           / random seed
</pre>
With this config, the database generated will be about 4.5GB,
with about 100 million trades and quotes (these values depend on the random seed).
<p>
Prices and sizes are generated by random walks, selecting those that
do not wander too far from outset. Prices are correlated.
<p>
There are 15 stocks.
If you change this, also change corresponding definitions of starting prices, etc.
<p>
Tables are:
<ul>
<li>
daily - daily open/high/low/close
<li>
depth - last day depth of book
<li>
mas - stock name master
<li>
nbbo - best bid/offer
<li>
quote - quotes
<li>
trade - trades
</ul>
<p>
For example:
<pre>q)\l db/tickdemo
q)count quote
81258538j
q)3#select from quote where date=last date, sym=`IBM
date       time         sym bid   ask   bsize asize mode ex
-----------------------------------------------------------
2010.12.31 09:30:00.012 IBM 37.92 38.92 35    35    B    N
2010.12.31 09:30:00.034 IBM 37.35 38.48 87    10         N
2010.12.31 09:30:00.043 IBM 37.84 38.47 66    50    Y    N
</pre>
<hr>
<p>
cdb 
<br>
14 Jan 2011
</body></html>
